/* Variables CSS para el tema oscuro (por defecto, como en la imagen) */
:root {
    --app-background: #000000; /* Negro puro para un fondo profundo */
    /* Componentes con Glassmorphism usan bases RGB y luego RGBA para transparencia */
    --header-background-base-rgb: 26, 32, 44; /* RGB de #1A202C */
    --header-background: rgba(var(--header-background-base-rgb), 0.7); /* Header con transparencia */
    --header-text: #FFFFFF; /* Texto blanco en el header */

    --text-primary: #F5F5F7; /* Blanco grisáceo para texto principal */
    --text-secondary: #8E8E93; /* Gris medio para texto secundario/detalles */
    --accent-blue: #0A84FF; /* Azul vibrante para acentos y enlaces */

    --card-background-base-rgb: 28, 28, 30; /* RGB de #1C1C1E */
    --card-background: rgba(var(--card-background-base-rgb), 0.6); /* Tarjetas con transparencia */
    --card-border: #3A3A3C; /* Borde sutil y más oscuro para las tarjetas */
    --separator-line: #4A4A4C; /* Gris oscuro para la línea vertical */

    /* Colores para las notas/etiquetas (tags) */
    --note-background-next: #0A2E5B; /* Azul oscuro para "Próximo" */
    --note-text-next: #6AA3EC; /* Azul claro para texto de "Próximo" */
    --note-background-optional: #4D3D10; /* Marrón oscuro para "Opcional" */
    --note-text-optional: #FDC700; /* Amarillo para texto de "Opcional" */
    --note-background-meal: #0E4E30; /* Verde oscuro para "Con el almuerzo" / "Antes de la cena" */
    --note-text-meal: #77D3A6; /* Verde claro para texto de "Con el almuerzo" */
    --note-background-tooth: #0A4F6B; /* Azul verdoso oscuro para "Diente" */
    --note-text-tooth: #87CEEB; /* Azul claro para texto de "Diente" */
    --note-background-day-specific: #29292B; /* Gris muy oscuro para el eyebrow de días */
    --note-text-day-specific: #C7C7CC; /* Gris claro para texto de días */
    --note-background-no-take: #6A0000; /* Rojo oscuro para "Hoy no se toma" */
    --note-text-no-take: #FF453A; /* Rojo vibrante para texto de "Hoy no se toma" */
    --note-background-glucometer: #0A3D5B; /* Azul oscuro para "Medir con glucómetro" */
    --note-text-glucometer: #87CEEB; /* Azul claro para texto de "Medir con glucómetro" */

    /* Botones y otros elementos */
    --button-on-header-bg-base-rgb: 41, 41, 43; /* RGB de #29292B */
    --button-on-header-bg: rgba(var(--button-on-header-base-rgb), 0.7);
    --button-on-header-text: #FFFFFF;
    --button-on-header-border: #3A3A3C;

    /* Colores para el resaltado del slot "Próximo" */
    --next-slot-line-highlight: #0A84FF; /* Azul vibrante */
    --next-slot-time-highlight: #FFFFFF; /* Hora en blanco puro */
}

/* Variables CSS para el tema claro */
@media (prefers-color-scheme: light) {
    :root {
        --app-background: #F5F5F7; /* Gris muy claro para el fondo */
        --header-background-base-rgb: 255, 255, 255; /* RGB de #FFFFFF */
        --header-background: rgba(var(--header-background-base-rgb), 0.8); /* Header con transparencia */
        --header-text: #1D1D1F; /* Negro para texto del header */

        --text-primary: #1D1D1F; /* Negro para texto principal */
        --text-secondary: #6E6E73; /* Gris oscuro para texto secundario */
        --accent-blue: #007AFF; /* Azul estándar de Apple para acentos */

        --card-background-base-rgb: 255, 255, 255; /* RGB de #FFFFFF */
        --card-background: rgba(var(--card-background-base-rgb), 0.7); /* Tarjetas con transparencia */
        --card-border: #E5E5EA; /* Gris claro para borde de tarjetas */
        --separator-line: #E5E5EA; /* Gris claro para la línea vertical */

        /* Colores para las notas/etiquetas (tags) en modo claro */
        --note-background-next: #E0F2FF; /* Azul muy claro para "Próximo" */
        --note-text-next: #007AFF; /* Azul oscuro para texto de "Próximo" */
        --note-background-optional: #FFFBEB; /* Amarillo muy claro para "Opcional" */
        --note-text-optional: #B8860B; /* Marrón para texto de "Opcional" */
        --note-background-meal: #E6FFFA; /* Verde muy claro para "Con el almuerzo" */
        --note-text-meal: #228B22; /* Verde oscuro para texto de "Con el almuerzo" */
        --note-background-tooth: #E6F8FF; /* Azul verdoso muy claro para "Diente" */
        --note-text-tooth: #007AFF; /* Azul oscuro para texto de "Diente" */
        --note-background-day-specific: #F0F0F0; /* Gris claro para el eyebrow de días */
        --note-text-day-specific: #6E6E73; /* Gris oscuro para texto de días */
        --note-background-no-take: #FFECEC; /* Rojo muy claro para "Hoy no se toma" */
        --note-text-no-take: #FF3B30; /* Rojo vibrante para texto de "Hoy no se toma" */
        --note-background-glucometer: #E0F2FF; /* Azul claro para "Medir con glucómetro" */
        --note-text-glucometer: #007AFF; /* Azul oscuro para texto de "Medir con glucómetro" */

        /* Botones y otros elementos en modo claro */
        --button-on-header-bg-base-rgb: 240, 240, 240; /* RGB de #F0F0F0 */
        --button-on-header-bg: rgba(var(--button-on-header-bg-base-rgb), 0.8);
        --button-on-header-text: #1D1D1F;
        --button-on-header-border: #D1D1D6;

        /* Colores para el resaltado del slot "Próximo" en modo claro */
        --next-slot-line-highlight: #007AFF; /* Azul estándar de Apple */
        --next-slot-time-highlight: #1D1D1F; /* Hora en negro */
    }
}

/* Estilos base del cuerpo y transiciones para el cambio de tema */
body {
    font-family: 'Inter', sans-serif;
    background-color: var(--app-background);
    color: var(--text-primary);
    transition: background-color 0.4s ease, color 0.4s ease;
}

/* Estilos generales para el contenedor principal */
.container {
    padding: 1rem; /* Espaciado general en los bordes */
}
@media (min-width: 640px) {
    .container {
        padding: 2rem;
    }
}

/* Estilos del Encabezado (Header) con Glassmorphism */
.header {
    position: sticky;
    top: 0;
    z-index: 1000; /* Alto z-index para que esté siempre visible */
    background-color: var(--header-background); /* Fondo RGBA */
    backdrop-filter: saturate(180%) blur(20px); /* Efecto de desenfoque y saturación */
    -webkit-backdrop-filter: saturate(180%) blur(20px); /* Compatibilidad Webkit */
    color: var(--header-text);
    transition: all 0.3s ease-in-out;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25); /* Sombra suave y profunda */
    padding: 1.5rem 1.25rem 0.5rem; /* Relleno inicial */
    display: grid;
    grid-template-columns: 1fr auto; /* Dos columnas para título/subtítulo y fecha/hora */
    grid-template-rows: auto auto; /* Dos filas para elementos del grid */
    gap: 0.5rem 1rem; /* Espacio entre elementos del grid */
    align-items: center;
    border-bottom: 1px solid rgba(var(--header-background-base-rgb), 0.15); /* Borde más sutil */
}

.header-left {
    grid-column: 1;
    grid-row: 1;
}

.header-right {
    grid-column: 2;
    grid-row: 1;
    text-align: right;
    font-size: 0.875rem; /* text-sm */
    color: var(--header-text); /* Asegura que la fecha tenga el color del header */
    line-height: 1.2;
}

.header-title {
    font-size: 1.75rem; /* text-3xl de Tailwind */
    font-weight: 700; /* font-bold */
    transition: font-size 0.3s ease-in-out;
}

.header-subtitle {
    font-size: 1rem; /* text-base */
    font-weight: 400;
    color: rgba(255, 255, 255, 0.7); /* Ligeramente más transparente */
    transition: opacity 0.3s ease-in-out, height 0.3s ease-in-out;
    display: block;
}

.header-full-date-time {
    display: block; /* Muestra por defecto */
}
.header-scrolled-date-time {
    display: none; /* Oculta por defecto */
    font-weight: 500;
    white-space: nowrap; /* Evita que se rompa la línea */
}

.header-button {
    grid-column: 1 / span 2; /* Ocupa ambas columnas */
    grid-row: 2;
    background-color: var(--button-on-header-bg); /* Fondo RGBA */
    color: var(--button-on-header-text);
    padding: 0.75rem 1.5rem;
    border-radius: 0.75rem; /* rounded-xl */
    font-weight: 600;
    display: flex;
    align-items: center;
    justify-content: center;
    width: fit-content; /* Se ajusta al contenido */
    margin: 0.5rem auto 1rem; /* Centrado y con margen */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Sombra suave para el botón */
    transition: all 0.3s ease-in-out;
    cursor: pointer;
    border: 1px solid var(--button-on-header-border); /* Borde sutil */
    backdrop-filter: saturate(180%) blur(10px); /* Glassmorphism para el botón */
    -webkit-backdrop-filter: saturate(180%) blur(10px);
}
.header-button:active {
    transform: scale(0.98); /* Efecto de clic */
}


/* Estilos del Header al hacer scroll */
.header.scrolled {
    padding: 0.5rem 1.25rem; /* Relleno menor */
    grid-template-rows: auto; /* Una sola fila */
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); /* Sombra más intensa al hacer scroll */
}

.header.scrolled .header-title {
    font-size: 1.25rem; /* text-xl */
}

.header.scrolled .header-subtitle,
.header.scrolled .header-button {
    opacity: 0;
    height: 0;
    overflow: hidden;
    pointer-events: none; /* Deshabilita clics */
    margin: 0;
    padding: 0;
}

.header.scrolled .header-full-date-time {
    opacity: 0;
    height: 0;
    overflow: hidden;
    display: none;
}
.header.scrolled .header-scrolled-date-time {
    display: inline-block; /* Muestra el texto corto */
    opacity: 1;
    transform: translateY(0);
    font-size: 0.875rem; /* text-sm */
    line-height: 1.2;
    color: var(--header-text); /* Asegura el color adecuado al hacer scroll */
}

/* Diseño de la lista de medicamentos */
.medication-day-section {
    padding-top: 1.5rem; /* Espacio superior para compensar el header sticky */
}

.time-slot {
    display: flex;
    margin-bottom: 0;
    padding-bottom: 1.5rem; /* Espacio al final de cada slot */
    transition: background-color 0.4s ease; /* Transición para el fondo del slot */
}

.time-indicator {
    flex-shrink: 0;
    width: 85px; /* Ancho fijo para la columna de la hora */
    text-align: right;
    padding-right: 1.25rem;
    padding-top: 0.3rem; /* Alineación vertical con el contenido */
    position: relative; /* Vuelve a ser relative */
    z-index: auto; /* Vuelve a auto */
    color: var(--text-secondary); /* Color secundario para la hora */
    font-weight: 500;
    font-size: 0.95rem;
    line-height: 1.3;
    transition: color 0.4s ease; /* Transición para el color de la hora */
}

.time-slot.is-next .time-indicator {
    color: var(--next-slot-time-highlight); /* Hora en blanco cuando es el siguiente */
    font-weight: 600; /* Más audaz */
}

.next-indicator {
    display: inline-flex; /* Usar flex para alinear emoji y texto */
    align-items: center;
    margin-top: 0.25rem;
    font-size: 0.75rem; /* Aumentado */
    font-weight: 600;
    background-color: var(--note-background-next);
    color: var(--note-text-next);
    padding: 0.2rem 0.6rem; /* Aumentado */
    border-radius: 9999px; /* Totalmente redondeado (pill shape) */
}


.medication-list {
    flex-grow: 1; /* Ocupa el espacio restante */
    padding-left: 1.25rem;
    border-left: 1px solid var(--separator-line); /* Línea vertical sutil */
    padding-top: 0;
    transition: border-left-color 0.4s ease, border-left-width 0.4s ease; /* Transición para el color y grosor de la línea */
}

.time-slot.is-next .medication-list {
    border-left-color: var(--next-slot-line-highlight); /* Línea azul vibrante */
    border-left-width: 3px; /* Línea más gruesa */
}


/* Estilos de las tarjetas de medicamentos con Glassmorphism */
.medication-item,
.medication-group-header {
    background-color: var(--card-background); /* Fondo RGBA */
    backdrop-filter: saturate(180%) blur(10px); /* Efecto de desenfoque y saturación para tarjetas */
    -webkit-backdrop-filter: saturate(180%) blur(10px);
    border-radius: 0.75rem; /* rounded-xl */
    /* *** MODIFICACIÓN AQUÍ: Ajuste de padding-top para hacer espacio al eyebrow *** */
    padding: 1.5rem 1rem 1rem; /* padding-top 1.5rem, otros lados 1rem */
    margin-bottom: 0.75rem; /* Espacio entre items */
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15); /* Sombra suave para las tarjetas */
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    border: 1px solid var(--card-border); /* Borde sutil */
    position: relative; /* Necesario para posicionar el eyebrow */
}
.medication-item:last-child {
    margin-bottom: 0; /* No margen en el último item de cada lista */
}

.medication-name {
    font-size: 1rem; /* text-base */
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
    transition: text-decoration 0.3s ease, color 0.3s ease; /* Transición para el tachado y color */
}
.medication-name.strikethrough {
    text-decoration: line-through;
    color: var(--text-secondary); /* Color más tenue cuando está tachado */
}

.medication-detail {
    font-size: 0.875rem; /* text-sm */
    color: var(--text-secondary);
    margin-bottom: 0;
}

.medication-group-header .medication-name {
    font-size: 1.125rem; /* text-lg */
    font-weight: 700;
    margin-bottom: 0.25rem;
}
.medication-group-header .medication-detail {
    font-size: 0.9rem;
    color: var(--text-secondary);
}

/* Estilos generales para notas (tags) */
.note-text {
    padding: 0.25rem 0.75rem; /* Aumentado */
    border-radius: 0.6rem; /* Aumentado */
    font-size: 0.8rem; /* Aumentado */
    font-weight: 500;
    margin-top: 0.5rem;
    display: inline-flex; /* Cambiado a inline-flex para alinear emoji y texto */
    align-items: center;
    line-height: 1.2;
}
.note-text span { /* Para el emoji */
    margin-right: 0.25rem;
    font-size: 0.9rem; /* Ajuste para el tamaño del emoji */
}


/* Estilos específicos para cada tipo de nota */
.optional-note .note-text {
    background-color: var(--note-background-optional);
    color: var(--note-text-optional);
}

.meal-note .note-text { /* Incluye "Antes del desayuno" y "Con el almuerzo" */
    background-color: var(--note-background-meal);
    color: var(--note-text-meal);
}

.glucometer-note .note-text {
    background-color: var(--note-background-glucometer);
    color: var(--note-text-glucometer);
}


/* Estilos para el eyebrow de días específicos */
.day-specific-eyebrow {
    font-size: 0.75rem; /* Aumentado */
    font-weight: 500;
    color: var(--note-text-day-specific);
    background-color: var(--note-background-day-specific);
    padding: 0.15rem 0.6rem; /* Aumentado */
    border-radius: 0.4rem; /* Aumentado */
    display: inline-flex;
    align-items: center;
    position: absolute;
    /* *** MODIFICACIÓN AQUÍ: Ajuste de la posición 'top' y 'left' *** */
    top: 0.25rem; /* Posiciona el eyebrow ligeramente dentro del padding superior */
    left: 1rem; /* Ajusta 'left' para que el inicio esté a la misma altura que el padding del card */
    z-index: 10; /* Asegura que esté por encima de la tarjeta */
}
.day-specific-eyebrow span { /* Para el emoji */
    margin-right: 0.25rem;
    font-size: 0.85rem;
}

/* Estilo para el chip "Hoy no se toma" */
.no-take-chip {
    background-color: var(--note-background-no-take);
    color: var(--note-text-no-take);
    padding: 0.25rem 0.75rem; /* Aumentado */
    border-radius: 0.6rem; /* Aumentado */
    font-size: 0.8rem; /* Aumentado */
    font-weight: 500;
    display: inline-flex; /* Cambiado a inline-flex para alinear emoji y texto */
    align-items: center;
    margin-left: 0.5rem; /* Espacio a la izquierda del nombre del medicamento */
    line-height: 1.2;
}
.no-take-chip span { /* Para el emoji */
    margin-right: 0.25rem;
    font-size: 0.9rem;
}


/* Ajustes responsivos para dispositivos pequeños */
@media (max-width: 640px) {
    .header {
        padding: 1.25rem 1rem 0.5rem;
        gap: 0.4rem 0.8rem;
    }
    .header.scrolled {
        padding: 0.4rem 1rem;
    }
    .header-title {
        font-size: 1.3rem;
    }
    .header.scrolled .header-title {
        font-size: 1.05rem;
    }
    .header-button {
        padding: 0.6rem 1.2rem;
        font-size: 0.9rem;
    }
    .time-indicator {
        width: 75px; /* Ancho menor en móviles */
        font-size: 0.85rem;
        padding-right: 0.8rem;
    }
    .medication-list {
        padding-left: 0.8rem;
    }
    .medication-item {
        /* *** MODIFICACIÓN AQUÍ (móvil): Ajuste de padding-top para el eyebrow *** */
        padding: 1.25rem 0.8rem 0.8rem; /* Ajustado para móvil, top 1.25rem */
        margin-bottom: 0.6rem;
    }
    .medication-name {
        font-size: 0.95rem;
    }
    .medication-detail {
        font-size: 0.8rem;
    }
    .medication-group-header {
        /* Se usa el mismo estilo que .medication-item, así que se beneficia del padding modificado */
        padding: 1.25rem 0.8rem 0.8rem; /* Ajustado para móvil, top 1.25rem */
        margin-bottom: 0.6rem;
    }
    .medication-group-header .medication-name {
        font-size: 1rem;
    }
    .day-specific-eyebrow {
        font-size: 0.7rem; /* Ajuste para móvil */
        /* *** MODIFICACIÓN AQUÍ (móvil): Ajuste de posición 'top' y 'left' *** */
        top: 0.2rem; /* Pequeño ajuste para móvil */
        left: 0.8rem; /* Pequeño ajuste para móvil */
        padding: 0.1rem 0.5rem;
    }
    .day-specific-eyebrow span {
        font-size: 0.75rem;
    }
    .no-take-chip {
        font-size: 0.7rem; /* Ajuste para móvil */
        padding: 0.2rem 0.6rem;
    }
    .no-take-chip span {
        font-size: 0.8rem;
    }
    .note-text {
        font-size: 0.7rem; /* Ajuste para móvil */
        padding: 0.2rem 0.6rem;
    }
    .note-text span {
        font-size: 0.8rem;
    }
}